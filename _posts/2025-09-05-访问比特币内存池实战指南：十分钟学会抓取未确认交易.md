---
layout:     post
title:      访问比特币内存池实战指南：十分钟学会抓取未确认交易
date:       2025-09-05
header-img: img/post-bg-desk.jpg
catalog: true
---

想实时预测矿工费用？准备自己写一个链上手续费仪表盘？关键第一步就是——**访问比特币内存池**，把还没来得及上链的未确认交易捞回来。本文用简练中文把完整流程拆成 3 个阶段，零门槛也能一次跑通。

## 什么是比特币内存池

> 比特币网络采用“先排队、再上链”的模式。所有合规交易在进入区块之前，都会先到**内存池（mempool）**排队。  
> 
> 内存池越大，**网络拥堵**与**手续费飙升**越明显，它是矿工与普通用户必须盯紧的晴雨表。

- **通识**：Bitcoin 指协议／网络，bitcoin 或 BTC 指代币本身。  
- **计量**：1 BTC = 1亿聪（satoshis）。矿工优先打包“聪/字节”标价最高的交易。  
- **历史升级**：SegWit 引入了“重量单位”，让区块可容纳约 4 倍数据，间接降低手续费。  
  - 经典交易：1 字节 = 1 vByte（4 重量单位）  
  - SegWit 交易：1 字节 = 1/4 vByte（1 重量单位）

内存池分析的核心价值：

1. **实时估算手续费**  
2. **监测行情爆发前夜**  
3. **设计链上风控策略**  
👉 [看不懂费用飙升？点击获取毫秒级链上预测工具](https://okxdog.com/)

---

## 必备原理：三行脚本搞定！

**提前准备**

- 任意终端（macOS / Windows / Linux）  
- 已部署比特币节点或 RPC 访问 URL  
- 对去中心化的热爱 :)

---

## 快速获取 RPC 入口

自己同步整条链太烧钱。注册一个 **免费云端节点** 就能拿到 HTTPS 节点地址，巡回测试 5 分钟完成。把生成的地址复制备用，下一步就是魔法开始的地方。

---

## 抓取内存池清单与交易详情

### 1. 拉出当前内存池全部交易

示例使用官方 `getrawmempool` 方法，可直接粘贴到你的终端：

```bash
curl --data-binary '{"jsonrpc":"1.0","id":"curltest","method":"getrawmempool","params":[true]}' \
     -H 'content-type:application/json' \
     https://NODE_URL_HERE
```

- 返回结果是一个 KV 字典，**键=交易哈希**，**值=详细信息**。

一张内存池交易（片段）示范：

```json
{
  "2d12...00d3": {
    "fees": {
      "base": 0.00111999
    },
    "size": 90826,
    "fee": 0.00111999,
    "time": 1629052793,
    "descendantcount": 1,
    "ancestorcount": 1,
    "bip125-replaceable": false
  }
}
```

字段速览

| 主键             | 含义                             |
|------------------|----------------------------------|
| fees             | 多个维度的手续费拆分             |
| size             | 交易原始字节                     |
| fee              | 以 BTC 计价的总费用               |
| time             | 入池时间戳（Unix）               |
| ancestorcount    | 该交易依赖的父交易数量            |
| bip125-replaceable | 可否用 RBF 替换                 |

---

### 2. 深入：解码完整交易

拿上面返回的交易 ID，再用 `getrawtransaction` 深挖原始交易体：

```bash
curl --data-binary '{"jsonrpc":"1.0","id":"curltest","method":"getrawtransaction","params":["2d1228abf0...00400d3",true]}' \
     -H 'content-type:application/json' \
     https://NODE_URL_HERE
```

关键输出片段示例（部分省略）：

```json
{
  "txid": "2d12...00d3",
  "hash": "...", 
  "size": 90826,
  "vsize": 22521,
  "locktime": 0,
  "vin": [...],
  "vout": [...],
  "confirmations": 0,
  "time": 1629052793,
  "blockhash": null
}
```

- **vsize（虚拟大小）**：决定你实际掏出多少 SAT/vByte。值越小，打包越有优势。  
- **locktime**：如果非 0，交易需等到指定区块高度后才能被打包。  
- **vin / vout**：所有输入输出与金额细节，数据足够你做风控评分。  
👉 [不确定钱包该给多少矿工费？点此立刻上线智能测算卡片](https://okxdog.com/)

---

## FAQ：新手最急迫的 5 个疑问

**Q1：没有节点还能用本文方法吗？**  
A：注册云端节点即可，10 秒拿到 HTTPS 入口；无需本地硬件投资。

**Q2：是否一定要 cURL？**  
A：不。Python 的 `requests.post()`、Node.js 的 `axios.post()` 都能发 JSON-RPC，代码行数相同。

**Q3：能否只挑选高费交易？**  
A：在解析结果时过滤 `fee / vsize` 数组即可，自动化脚本 2 行代码搞定。

**Q4：返回数据太大怎么办？**  
A：可把 `getrawmempool` 的第二个参数改为 `false`，仅返回哈希列表，后端按需再 pull。

**Q5：内存池会一直增长吗？**  
A：不会。交易一旦被打包就移出内存池，全部清除后大小归零。遇网络拥堵才会反弹。

---

## 写在最后

恭喜！你已掌握三样硬核技能：

1. 理解内存池与费用市场的互动逻辑  
2. 用纯命令行实时抓取未确认交易  
3. 解析原始交易体，研判手续费竞争格局  

把脚本跑成自动化任务，你能提前捕捉到链上行情，也能用数据说话，告诉团队今天到底该不该急于发币。

工程量不大，思维升级巨大。现在就运行第一条 curl，体验“链在指尖跳动”的乐趣！